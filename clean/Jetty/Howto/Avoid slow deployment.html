<html>
<head>
    <title>Jetty WTP Plugin</title>
    <link rel="stylesheet" media="screen, print" href="wiki-style.css"/>
</head>
<body>
<div class="col-md-20" id="mainContent">
                      <ul role="tablist" class="nav nav-tabs noprint hidden-print">
                       <li id="ca-nstab-main" class="active"><a accesskey="c" title="View the content page [c]" tabindex="-1" href="Avoid slow deployment.html">Page</a></li>
                        <li class="new" id="ca-talk"><a tabindex="-1" href="edit" accesskey="t" title="Discussion about the content page [t]">Discussion</a></li>
                        <li id="ca-viewsource"><a accesskey="e" title="This page is protected.&#10;You can view its source [e]" tabindex="-1" href="edit">View source</a></li>
                        <li class="collapsible" id="ca-history"><a href="edit" tabindex="-1" accesskey="h" title="Past revisions of this page [h]">History</a></li>
                      </ul>            <div class="tab-content background-white">
              <div class="tab-pane active" id="tab-pane-main-page-content">

                
                <h1 id="firstHeading" class="firstHeading page-header">
                  <span dir="auto">Jetty/Howto/Avoid slow deployment</span>
                </h1>
                <div id="main-page-content">
                                                      <!-- subtitle -->
                  <div class="alert alert-small alert-warning" id="contentSub"><span class="subpages">&lt; <a href="../../Jetty.html" title="Jetty">Jetty</a>‎ | <a href="../Howto.html" title="Jetty/Howto">Howto</a></span></div>
                  <!-- /subtitle -->
                  
                  
                  <div lang="en" dir="ltr" id="mw-content-text" class="mw-content-ltr"><p><br/>
</p><p><br/>
</p>
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>Annotations and annotation scanning was added to servlet specification 2.5. Since that time, there has been the possibility that your webapp will need to have all of its classes scanned at deployment to find annotations. The attribute <tt>metadata-complete</tt> was added in order to prevent unnecessary scanning. If you do not set <tt>metadata-complete=true</tt>, you risk slow deployment due to annotation scanning. If you have a large number of jars in your webapp, this can be very time consuming.
</p><p>Since servlet 3.0 (supported by jetty-8.x), there has been the added requirement that both container and webapp jars can be scanned. In fact, even if you do set <tt>metadata-complete=true</tt> in your web.xml, scanning will probably still occur, due to the requirement to support the new ServletContainerInitializers. See 
<a class="external free" rel="nofollow" href="http://java.net/jira/browse/SERVLET_SPEC-36">http://java.net/jira/browse/SERVLET_SPEC-36</a>.
</p><p>This being the case, it is important that you control which jars are scanned in order to cut down deployment time.
</p>
<h2><span id="Remedy" class="mw-headline">Remedy</span></h2>
<p>Jetty allows for the configuration of 2 different context attributes that control which jars are scanned. One controls which container jars are scanned, and the other controls which webapp jars are scanned:
</p>
<ul><li> <tt>org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern</tt>. The primary use for this attribute is to control which jars are scanned for tlds in jetty-7. You can find information on which jars to include here: <a href="Configure JSP.html#Jetty_7.x" title="Jetty/Howto/Configure JSP">Configuring JSP</a>. In jetty-8, tlds are found via other means and thus this attribute has less importance. Note that if this attribute is *not* set, *no* container jars are scanned. You must set it if you want particular jars scanned.</li></ul>
<ul><li> <tt>org.eclipse.jetty.server.webapp.WebInfIncludeJarPattern</tt>. By default, if this attribute is not set, all jars in WEB-INF/lib will be scanned. You can selectively include jars to be scanned by defining a series of patterns. For example, given this listing of files in WEB-INF/lib:</li></ul>
<div class="mw-geshi mw-code mw-content-ltr" dir="ltr"><div class="bash source-bash"><pre class="de1">WEB-INF<span class="sy0">/</span>lib<span class="sy0">/</span>
           foo-api-1.2.3.jar
           foo-1.2.3.jar
           bar-<span class="nu0">0.9</span>.jar
           boo-<span class="nu0">1.0</span>.jar</pre></div></div>
<p><br/>
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="xml source-xml"><pre class="de1"><span class="sc3"><span class="re1">&lt;Configure</span> <span class="re0">class</span>=<span class="st0">"org.eclipse.jetty.webapp.WebAppContext"</span><span class="re2">&gt;</span></span>
 
    <span class="sc3"><span class="re1">&lt;Call</span> <span class="re0">name</span>=<span class="st0">"setAttribute"</span><span class="re2">&gt;</span></span>
      <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>org.eclipse.jetty.server.webapp.WebInfIncludeJarPattern<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>.*/.*foo-api-[^/]\.jar$|./.*bar-[^/]\.jar$|./.*wibble[^/]*\.jar$<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/Call<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/Configure<span class="re2">&gt;</span></span></span></pre></div></div>
<p>Then the following files would match and be scanned:
</p>
<div class="mw-geshi mw-code mw-content-ltr" dir="ltr"><div class="bash source-bash"><pre class="de1">WEB-INF<span class="sy0">/</span>lib<span class="sy0">/</span>
           foo-api-1.2.3.jar
           bar-<span class="nu0">0.9</span>.jar</pre></div></div>
<p>Patterns are specified using <a rel="nofollow" class="external text" href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">java regex expressions</a>.
</p><p>Context attributes can be set for a single webapp:
</p>
<ul><li> in a <a title="Jetty/Feature/ContextDeployer" class="mw-redirect" href="https://wiki.eclipse.org/Jetty/Feature/ContextDeployer">context xml</a> file</li>
<li> in code by calling <a href="http://download.eclipse.org/jetty/stable-7/apidocs/org/eclipse/jetty/webapp/WebAppContext.html" class="external free" rel="nofollow">http://download.eclipse.org/jetty/stable-7/apidocs/org/eclipse/jetty/webapp/WebAppContext.html</a></li></ul>
<p>Context attributes can be set for multiple webapps by configuring the <a title="Jetty/Feature/Deployment Manager" href="../Feature/Deployment Manager.html">Deployment Manager</a>.
</p>
<!-- 
NewPP limit report
Cached time: 20211116150353
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.064 seconds
Real time usage: 0.075 seconds
Preprocessor visited node count: 39/1000000
Preprocessor generated node count: 293/1000000
Post‐expand include size: 2869/2097152 bytes
Template argument size: 2634/2097152 bytes
Highest expansion depth: 4/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   59.487      1 - -total
100.00%   59.487      1 - Template:Jetty_Howto
  8.49%    5.052      1 - Template:Jetty
-->

<!-- Saved in parser cache with key my_wiki:pcache:idhash:39327-0!*!0!!*!*!* and timestamp 20211116150353 and revision id 319584
 -->
</div>
                                      <!-- catlinks -->
                    <div class="catlinks" id="catlinks"><div class="mw-normal-catlinks" id="mw-normal-catlinks"><a title="Special:Categories" href="https://wiki.eclipse.org/Special:Categories">Categories</a>: <ul><li><a title="Category:Jetty" href="https://wiki.eclipse.org/Category:Jetty">Jetty</a></li><li><a title="Category:Jetty Howto" href="https://wiki.eclipse.org/Category:Jetty_Howto">Jetty Howto</a></li></ul></div></div>                     <!-- /catlinks -->
                                  </div>
              </div>
            </div>
          </div>
</body>
</html>
