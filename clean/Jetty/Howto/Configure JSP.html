<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Jetty/Howto/Configure JSP - (Archive Wiki)</title>
    <link href="../../wiki-style.css" media="screen, print" rel="stylesheet" />
  </head>
  <body>
    <div class="heading">
      <p class="heading-title">Archive of wiki.eclipse.org/jetty for End of Life (EOL) Eclipse Jetty 7 and Eclipse Jetty 8.</p>
      <p class="heading-link">
        For up-to-date documentation see
        <a href="https://eclipse.org/jetty">Eclipse Jetty</a>
        project page.
      </p>
      <p class="heading-nav">
        <a href="Jetty.html">Eclipse Jetty 7 Archive Home</a>
      </p>
    </div>
    <div class="col-md-20" id="mainContent">
      <div class="tab-content background-white">
        <div class="tab-pane active" id="tab-pane-main-page-content">
          <h1 class="firstHeading page-header" id="firstHeading">
            <span dir="auto">Jetty/Howto/Configure JSP</span>
          </h1>
          <div id="main-page-content">
            <div class="alert alert-small alert-warning" id="contentSub">
              <span class="subpages">
                &lt;
                <a href="../../Jetty.html" title="Jetty">Jetty</a>
                |
                <a href="../Howto.html" title="Jetty/Howto">Howto</a>
              </span>
            </div>
            <div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en">
              <div class="toc" id="toc">
                <div id="toctitle">
                  <h2>Contents</h2>
                </div>
                <ul>
                  <li class="toclevel-1">
                    <a href="Configure%20JSP.html#Introduction">
                      <span class="tocnumber">1</span>
                      <span class="toctext">Introduction</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Configure%20JSP.html#Compiling_JSPs">
                      <span class="tocnumber">2</span>
                      <span class="toctext">Compiling JSPs</span>
                    </a>
                    <ul>
                      <li class="toclevel-2">
                        <a href="Configure%20JSP.html#Jetty_Maven_Plugin">
                          <span class="tocnumber">2.1</span>
                          <span class="toctext">Jetty Maven Plugin</span>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="toclevel-1">
                    <a href="Configure%20JSP.html#Configuring_JSP">
                      <span class="tocnumber">3</span>
                      <span class="toctext">Configuring JSP</span>
                    </a>
                  </li>
                  <li class="toclevel-1 tocsection-4">
                    <a href="Configure%20JSP.html#Understanding_JSP_2.1_Parameters">
                      <span class="tocnumber">4</span>
                      <span class="toctext">Understanding JSP 2.1 Parameters</span>
                    </a>
                  </li>
                  <li class="toclevel-1 tocsection-5">
                    <a href="Configure%20JSP.html#Modifying_the_Configuration">
                      <span class="tocnumber">5</span>
                      <span class="toctext">Modifying the Configuration</span>
                    </a>
                    <ul>
                      <li class="toclevel-2 tocsection-6">
                        <a href="Configure%20JSP.html#Overriding_webdefault.xml">
                          <span class="tocnumber">5.1</span>
                          <span class="toctext">Overriding webdefault.xml</span>
                        </a>
                      </li>
                      <li class="toclevel-2 tocsection-7">
                        <a href="Configure%20JSP.html#Configuring_the_JSP_Servlet_in_web.xml">
                          <span class="tocnumber">5.2</span>
                          <span class="toctext">Configuring the JSP Servlet in web.xml</span>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="toclevel-1 tocsection-8">
                    <a href="Configure%20JSP.html#Using_JSTL_Taglibs_for_Jetty_7.x_and_8.x">
                      <span class="tocnumber">6</span>
                      <span class="toctext">Using JSTL Taglibs for Jetty 7.x and 8.x</span>
                    </a>
                    <ul>
                      <li class="toclevel-2 tocsection-9">
                        <a href="Configure%20JSP.html#Jetty_7.x">
                          <span class="tocnumber">6.1</span>
                          <span class="toctext">Jetty 7.x</span>
                        </a>
                      </li>
                      <li class="toclevel-2 tocsection-10">
                        <a href="Configure%20JSP.html#Jetty_8.x">
                          <span class="tocnumber">6.2</span>
                          <span class="toctext">Jetty 8.x</span>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="toclevel-1 tocsection-11">
                    <a href="Configure%20JSP.html#Using_JSF_Taglibs">
                      <span class="tocnumber">7</span>
                      <span class="toctext">Using JSF Taglibs</span>
                    </a>
                    <ul>
                      <li class="toclevel-2 tocsection-12">
                        <a href="Configure%20JSP.html#Jetty_Standalone">
                          <span class="tocnumber">7.1</span>
                          <span class="toctext">Jetty Standalone</span>
                        </a>
                      </li>
                      <li class="toclevel-2 tocsection-13">
                        <a href="Configure%20JSP.html#Jetty_Maven_Plugin_2">
                          <span class="tocnumber">7.2</span>
                          <span class="toctext">Jetty Maven Plugin</span>
                        </a>
                      </li>
                    </ul>
                  </li>
                </ul>
              </div>
              <h2>
                <span class="mw-headline" id="Introduction">Introduction</span>
              </h2>
              <p>
                <br />
                This page provides information about configuring JSP.
              </p>
              <h2>
                <span class="mw-headline" id="Compiling_JSPs">Compiling JSPs</span>
              </h2>
              <p>
                To compile
                <tt>.jsp</tt>
                files into Java classes, you need a Java compiler. You can acquire a Java compiler from the JVM if you are using a full JDK, or from a third party Jar.
              </p>
              <p>
                In versions of Jetty prior to 7.5.0, the JSP infrastructure made use of the Eclipse Java Compiler (
                <tt>ecj.jar</tt>
                ) which is supplied in
                <tt>$JETTY_HOME/lib/jsp</tt>
                . For jetty-7.5.0 we upgraded the version of JSP to
                <tt>jsp-impl-2.1.3.b10</tt>
                (from Glassfish). In this version, the JSP infrastructure ALWAYS tries to acquire a Java compiler from the JVM if the version of Java is 1.6 or above. Therefore, if you are using a JRE, JSPs are unable to compile so you must use a full JDK. Alternatively, you can precompile your JSPs (which is preferable in a production deployment in any case). The
                <a class="removed" title="Jetty/Feature/Jetty Jspc Maven Plugin">Jetty JSPC Maven Plugin</a>
                is helpful for precompilation.
              </p>
              <p>
                If using jetty-7.5.5 and beyond (including jetty-8.x), you can use
                <i>either</i>
                a full JDK
                <i>or</i>
                a JRE in combination with a third party Java compiler (such as ecj which we distribute in $JETTY_HOME/lib/jsp). To use the ecj compiler, you need to set a SystemProperty. You can do this either in your code or in a jetty config file. Here's the snippet that you can put into
                <tt>jetty.xml</tt>
                :
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="xml source-xml">
                  <pre class="de1" xml:space="preserve">  <span class="sc3"><span class="re1">&lt;Call</span> <span class="re0">class</span>=<span class="st0">"java.lang.System"</span>  <span class="re0">name</span>=<span class="st0">"setProperty"</span><span class="re2">&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>org.apache.jasper.compiler.disablejsr199<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>true<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
  <span class="sc3"><span class="re1">&lt;/Call<span class="re2">&gt;</span></span></span></pre>
                </div>
              </div>
              <p>
                Or alternatively, you can put this System property into
                <tt>start.ini</tt>
                :
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="text source-text">
                  <pre class="de1" xml:space="preserve"> -Dorg.apache.jasper.compiler.disablejsr199=true</pre>
                </div>
              </div>
              <h3>
                <span class="mw-headline" id="Jetty_Maven_Plugin">Jetty Maven Plugin</span>
              </h3>
              <p>
                Since jetty-7.5.0 we upgraded the version of JSP to
                <tt>jsp-impl-2.1.3.b10</tt>
                (from Glassfish). In this version, the JSP infrastructure ALWAYS tries to acquire a Java compiler from the JVM if the version of Java is 1.6 or above. Therefore, if you are using a JRE, JSPs are unable to compile so you must use a full JDK.
              </p>
              <p>We hope to be able to introduce a patch to allow the use of 3rd party jars in an upcoming release of the plugin. This page will be updated when we have more information.</p>
              <p>
                <br />
              </p>
              <h2>
                <span class="mw-headline" id="Configuring_JSP">Configuring JSP</span>
              </h2>
              <p>The JSP engine has many configuration parameters. Some parameters affect only precompilation, and some affect runtime recompilation checking. Parameters also differ between the 2.0 and 2.1 release of the JSP engine. This page lists the configuration parameters, their meanings and their default settings.</p>
              <h2>
                <span class="mw-headline" id="Understanding_JSP_2.1_Parameters">Understanding JSP 2.1 Parameters</span>
              </h2>
              <table border="1" cellspacing="0">
                <tbody>
                  <tr>
                    <th scope="col" width="100">init param</th>
                    <th scope="col" width="500">Description</th>
                    <th scope="col" width="100">Default</th>
                    <th scope="col" width="100">webdefault.xml</th>
                  </tr>
                  <tr>
                    <td>development</td>
                    <td>
                      If
                      <tt>development=true</tt>
                      , recompilation checks occur on each request. See also
                      <tt>modificationTestInterval</tt>
                      .
                    </td>
                    <td>TRUE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>fork</td>
                    <td>Should Ant fork its java compiles of JSP pages?</td>
                    <td>TRUE</td>
                    <td>FALSE</td>
                  </tr>
                  <tr>
                    <td>keepgenerated</td>
                    <td>Do you want to keep the generated Java files around?</td>
                    <td>FALSE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>saveByteCode</td>
                    <td>If class files are generated as byte arrays, should they be saved to disk at the end of compilations?</td>
                    <td>FALSE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>trimSpaces</td>
                    <td>Should white spaces between directives or actions be trimmed?</td>
                    <td>FALSE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>enablePooling</td>
                    <td>Determines whether tag handler pooling is enabled.</td>
                    <td>TRUE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>mappedFile</td>
                    <td>Support for mapped Files. Generates a servlet that has a print statement per line of the JSP file.</td>
                    <td>TRUE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>sendErrorToClient</td>
                    <td>If false, stack traces, etc., are sent to std error instead of the client's browser.</td>
                    <td>FALSE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>classdebuginfo</td>
                    <td>Include debugging info in class file.</td>
                    <td>TRUE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>checkInterval</td>
                    <td>
                      Interval in seconds between background recompile checks. Only relevant if
                      <tt>development=false</tt>
                      .
                    </td>
                    <td>0</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>suppressSmap</td>
                    <td>Generation of SMAP info for JSR45 debugging.</td>
                    <td>FALSE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>dumpSmap</td>
                    <td>Dump SMAP JSR45 info to a file.</td>
                    <td>FALSE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>genStrAsCharArray</td>
                    <td>Option for generating Strings.</td>
                    <td>FALSE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>genStrAsByteArray</td>
                    <td>Option for generating Strings.</td>
                    <td>TRUE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>defaultBufferNone</td>
                    <td />
                    <td>FALSE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>errorOnUseBeanInvalidClassAttribute</td>
                    <td />
                    <td>FALSE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>scratchDir</td>
                    <td>
                      <p>Directory where servlets are generated. Jetty sets this value according to the [/display/JETTY/Temporary+Directories work dir] settings for the webapp.</p>
                    </td>
                    <td>-</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>compiler</td>
                    <td>Determined at runtime. For Jetty this is the Eclipse jdt compiler.</td>
                  </tr>
                  <tr>
                    <td>compilerTargetVM</td>
                    <td>Target vm to compile for.</td>
                    <td>1.5</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>compilerSourceVM</td>
                    <td>Sets source compliance level for the jdt compiler.</td>
                    <td>1.5</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>javaEncoding</td>
                    <td>Pass through the encoding to use for the compilation.</td>
                    <td>UTF8</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>modificationTestInterval</td>
                    <td>
                      If
                      <tt>development=true</tt>
                      , interval between recompilation checks, triggered by a request.
                    </td>
                    <td>0</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>xpoweredBy</td>
                    <td>Generate an X-Powered-By response header.</td>
                    <td>FALSE</td>
                    <td>FALSE</td>
                  </tr>
                  <tr>
                    <td>usePrecompiled/use-precompiled</td>
                    <td />
                    <td>FALSE</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>validating/enableTldValidation</td>
                    <td>Whether or not to validate tag files against the schema.</td>
                    <td>FALSE</td>
                    <td />
                  </tr>
                  <tr>
                    <td>reload-interval</td>
                    <td>
                      If
                      <tt>reload-interval=0</tt>
                      , then no runtime checking of JSP, otherwise sets the checking interval for both
                      <tt>development=true</tt>
                      and
                      <tt>development=false</tt>
                      .
                    </td>
                    <td />
                    <td />
                  </tr>
                  <tr>
                    <td>initial-capacity/initialCapacity</td>
                    <td>The initial capacity of the hash maps mapping the name of the JSP to class and JSP file.</td>
                    <td />
                    <td />
                  </tr>
                  <tr>
                    <td>httpMethods</td>
                    <td>List of names of http methods which the JSP servlet will service (there is no requirement that these names are restricted to the set defined by rfc2616). Null or a value of "*" means any and all methods. Names should be comma, tab or newline delimited.</td>
                    <td>Null</td>
                    <td />
                  </tr>
                </tbody>
              </table>
              <p>
                <br />
                Much confusion generally ensues about the
                <tt>development</tt>
                ,
                <tt>checkInterval</tt>
                and
                <tt>modificationTestInterval</tt>
                parameters and JSP runtime recompilation. Here is a factoring out of the various options:
              </p>
              <ol>
                <li>
                  Check the JSP files for possible recompilation on every request:
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve"><span class="sc3"><span class="re1">&lt;init-param<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;param-name<span class="re2">&gt;</span></span></span>development&gt;<span class="sc3"><span class="re1">&lt;/param-name<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;param-value<span class="re2">&gt;</span></span></span>true&gt;<span class="sc3"><span class="re1">&lt;/param-value<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/init-param<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                </li>
                <li>
                  Only check approximately every N seconds, where a request will trigger the time-lapse calculation. This example checks every 60 seconds:
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve"><span class="sc3"><span class="re1">&lt;init-param<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;param-name<span class="re2">&gt;</span></span></span>development&gt;<span class="sc3"><span class="re1">&lt;/param-name<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;param-value<span class="re2">&gt;</span></span></span>true&gt;<span class="sc3"><span class="re1">&lt;/param-value<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/init-param<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;init-param<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;param-name<span class="re2">&gt;</span></span></span>modificationTestInterval&gt;<span class="sc3"><span class="re1">&lt;/param-name<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;param-value<span class="re2">&gt;</span></span></span>60&gt;<span class="sc3"><span class="re1">&lt;/param-value<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/init-param<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                </li>
                <li>
                  Do no checking whatsoever, but still compile the JSP on the very first hit. (Note: this
                  <i>reload-interval</i>
                  parameter is shorthand for a
                  <i>development=false</i>
                  and
                  <i>checkInterval=0</i>
                  combination.):
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve"><span class="sc3"><span class="re1">&lt;init-param<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;param-name<span class="re2">&gt;</span></span></span>reload-interval&gt;<span class="sc3"><span class="re1">&lt;/param-name<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;param-value<span class="re2">&gt;</span></span></span>-1&gt;<span class="sc3"><span class="re1">&lt;/param-value<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/init-param<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                </li>
                <li>
                  Don't do any request-time checking, but instead start a background thread to do checks every N seconds. This example checks every 60 seconds:
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve"><span class="sc3"><span class="re1">&lt;init-param<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;param-name<span class="re2">&gt;</span></span></span>development&gt;<span class="sc3"><span class="re1">&lt;/param-name<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;param-value<span class="re2">&gt;</span></span></span>false&gt;<span class="sc3"><span class="re1">&lt;/param-value<span class="re2">&gt;</span></span></span>
 <span class="sc3"><span class="re1">&lt;/init-param<span class="re2">&gt;</span></span></span>
 <span class="sc3"><span class="re1">&lt;init-param<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;param-name<span class="re2">&gt;</span></span></span>checkInterval&gt;<span class="sc3"><span class="re1">&lt;/param-name<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;param-value<span class="re2">&gt;</span></span></span>60&gt;<span class="sc3"><span class="re1">&lt;/param-value<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/init-param<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                  <p>
                    <br />
                  </p>
                  <h2>
                    <span class="mw-headline" id="Modifying_the_Configuration">Modifying the Configuration</span>
                  </h2>
                  <p>There are several options for modifying the Jasper JSP servlet configuration.</p>
                  <h3>
                    <span class="mw-headline" id="Overriding_webdefault.xml">
                      Overriding
                      <tt>webdefault.xml</tt>
                    </span>
                  </h3>
                  <p>
                    You can make a copy of the
                    <a href="../Reference/webdefault.xml.html" title="Jetty/Reference/webdefault.xml">webdefault.xml</a>
                    shipped with Jetty, apply your changes, and use it instead of the shipped version. The example below shows how to do this when using the Jetty Maven plugin.
                  </p>
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve">  <span class="sc3"><span class="re1">&lt;plugin<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;groupId<span class="re2">&gt;</span></span></span>org.mortbay.jetty<span class="sc3"><span class="re1">&lt;/groupId<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;artifactId<span class="re2">&gt;</span></span></span>jetty-maven-plugin<span class="sc3"><span class="re1">&lt;/artifactId<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;configuration<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;webAppConfig<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;defaultsDescriptor<span class="re2">&gt;</span></span></span>src/main/resources/webdefault.xml<span class="sc3"><span class="re1">&lt;/defaultsDescriptor<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/webAppConfig<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;connectors<span class="re2">&gt;</span></span></span>
    ..</pre>
                    </div>
                  </div>
                  <p>
                    If you're using Jetty standalone, and you want to change the JSP settings for just one or a few of your webapps, then copy the
                    <tt>$JETTY_HOME/etc/webdefault.xml</tt>
                    file somewhere, modify it, and then use a
                    <a class="mw-redirect removed" title="Jetty/Feature/ContextDeployer">context xml</a>
                    file to set this file as the webdefaults for your webapp. Here's a snippet:
                  </p>
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve"> <span class="sc3"><span class="re1">&lt;Configure</span> <span class="re0">class</span>=<span class="re2">&gt;</span></span>"org.eclipse.jetty.webapp.WebAppContext"&gt;
 
   <span class="sc3"><span class="re1">&lt;Set</span> <span class="re0">name</span>=<span class="re2">&gt;</span></span>"contextPath"&gt;/foo<span class="sc3"><span class="re1">&lt;/Set<span class="re2">&gt;</span></span></span>
   <span class="sc3"><span class="re1">&lt;Set</span> <span class="re0">name</span>=<span class="re2">&gt;</span></span>"war"&gt;<span class="sc3"><span class="re1">&lt;SystemProperty</span> <span class="re0">name</span>=<span class="re2">&gt;</span></span>"jetty.home" &gt;default=&gt;"."/&gt;/webapps/foobar.war<span class="sc3"><span class="re1">&lt;/Set<span class="re2">&gt;</span></span></span>
   <span class="sc3"><span class="re1">&lt;Set</span> <span class="re0">name</span>=<span class="re2">&gt;</span></span>"defaultsDescriptor"&gt;/home/smith/dev/webdefault.xml<span class="sc3"><span class="re1">&lt;/Set<span class="re2">&gt;</span></span></span>
 
 <span class="sc3"><span class="re1">&lt;/Configure<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                  <p>
                    If you want to change the JSP settings for all of the webapps, then edit the
                    <tt>$JETTY_HOME/etc/webdefaults.xml</tt>
                    file directly instead.
                  </p>
                  <h3>
                    <span class="mw-headline" id="Configuring_the_JSP_Servlet_in_web.xml">
                      Configuring the JSP Servlet in
                      <tt>web.xml</tt>
                    </span>
                  </h3>
                  <p>
                    Another option is to add an entry for the Jasper JSP servlet to the
                    <i>web.xml</i>
                    file of your webapp. You can use the entry in
                    <a href="../Reference/webdefault.xml.html" title="Jetty/Reference/webdefault.xml">webdefault.xml</a>
                    as a starting point.
                  </p>
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve"> <span class="sc3"><span class="re1">&lt;servlet</span> <span class="re0">id</span>=<span class="re2">&gt;</span></span>"jsp"&gt;
     <span class="sc3"><span class="re1">&lt;servlet-name<span class="re2">&gt;</span></span></span>jsp<span class="sc3"><span class="re1">&lt;/servlet-name<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;servlet-class<span class="re2">&gt;</span></span></span>org.apache.jasper.servlet.JspServlet<span class="sc3"><span class="re1">&lt;/servlet-class<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;init-param<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;param-name<span class="re2">&gt;</span></span></span>logVerbosityLevel<span class="sc3"><span class="re1">&lt;/param-name<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;param-value<span class="re2">&gt;</span></span></span>DEBUG<span class="sc3"><span class="re1">&lt;/param-value<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;/init-param<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;init-param<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;param-name<span class="re2">&gt;</span></span></span>fork<span class="sc3"><span class="re1">&lt;/param-name<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;param-value<span class="re2">&gt;</span></span></span>false<span class="sc3"><span class="re1">&lt;/param-value<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;/init-param<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;init-param<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;param-name<span class="re2">&gt;</span></span></span>keepgenerated<span class="sc3"><span class="re1">&lt;/param-name<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;param-value<span class="re2">&gt;</span></span></span>true<span class="sc3"><span class="re1">&lt;/param-value<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;/init-param<span class="re2">&gt;</span></span></span>
     ...
 
     <span class="sc3"><span class="re1">&lt;load-on-startup<span class="re2">&gt;</span></span></span>0<span class="sc3"><span class="re1">&lt;/load-on-startup<span class="re2">&gt;</span></span></span>
   <span class="sc3"><span class="re1">&lt;/servlet<span class="re2">&gt;</span></span></span>
 
   <span class="sc3"><span class="re1">&lt;servlet-mapping<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;servlet-name<span class="re2">&gt;</span></span></span>jsp<span class="sc3"><span class="re1">&lt;/servlet-name<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;url-pattern<span class="re2">&gt;</span></span></span>*.jsp<span class="sc3"><span class="re1">&lt;/url-pattern<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;url-pattern<span class="re2">&gt;</span></span></span>*.jspf<span class="sc3"><span class="re1">&lt;/url-pattern<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;url-pattern<span class="re2">&gt;</span></span></span>*.jspx<span class="sc3"><span class="re1">&lt;/url-pattern<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;url-pattern<span class="re2">&gt;</span></span></span>*.xsp<span class="sc3"><span class="re1">&lt;/url-pattern<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;url-pattern<span class="re2">&gt;</span></span></span>*.JSP<span class="sc3"><span class="re1">&lt;/url-pattern<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;url-pattern<span class="re2">&gt;</span></span></span>*.JSPF<span class="sc3"><span class="re1">&lt;/url-pattern<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;url-pattern<span class="re2">&gt;</span></span></span>*.JSPX<span class="sc3"><span class="re1">&lt;/url-pattern<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;url-pattern<span class="re2">&gt;</span></span></span>*.XSP<span class="sc3"><span class="re1">&lt;/url-pattern<span class="re2">&gt;</span></span></span>
   <span class="sc3"><span class="re1">&lt;/servlet-mapping<span class="re2">&gt;</span></span></span>
 
   <span class="sc3"><span class="re1">&lt;servlet</span> <span class="re0">id</span>=<span class="re2">&gt;</span></span>"my-servlet"&gt;
     <span class="sc3"><span class="re1">&lt;servlet-name<span class="re2">&gt;</span></span></span>myServlet<span class="sc3"><span class="re1">&lt;/servlet-name<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;servlet-class<span class="re2">&gt;</span></span></span>com.acme.servlet.MyServlet<span class="sc3"><span class="re1">&lt;/servlet-class<span class="re2">&gt;</span></span></span>
      ...</pre>
                    </div>
                  </div>
                  <h2>
                    <span class="mw-headline" id="Using_JSTL_Taglibs_for_Jetty_7.x_and_8.x">Using JSTL Taglibs for Jetty 7.x and 8.x</span>
                  </h2>
                  <hr />
                  <h3>
                    <span class="mw-headline" id="Jetty_7.x">Jetty 7.x</span>
                  </h3>
                  <p>
                    The JSTL tags are present in the
                    <tt>org.apache.taglibs.standard.glassfish</tt>
                    Jar in
                    <tt>$JETTY_HOME/lib/jsp</tt>
                    . For the Jetty/jsp integration to find them, you need to configure a pattern that defines the names of files in the container's classpath that contain
                    <tt>.tld</tt>
                    files. You must define the pattern as a context attribute on
                    <i>each</i>
                    context that you deploy. The context attribute and pattern is:
                  </p>
                  <pre xml:space="preserve"> attribute: org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern
 value: .*/.*jsp-api-[^/]*\.jar$|.*/.*jsp-[^/]*\.jar$|.*/.*taglibs[^/]*\.jar$
</pre>
                  <p>
                    If you are using the Jetty deployers (that is, your
                    <tt>start.ini</tt>
                    file contains
                    <tt>etc/jetty-deploy.xml</tt>
                    ), you don't need to do anything, as the pattern is pre-defined in
                    <tt>etc/jetty-deploy.xml</tt>
                    , and the deployer makes sure the attribute is set on each and every context it deploys. If you are NOT using the deployers, you need to configure the attribute on
                    <i>each</i>
                    context you set. Here's an example:
                  </p>
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve"><span class="sc3"><span class="re1">&lt;New</span> <span class="re0">class</span>=<span class="st0">"org.eclipse.jetty.webapp.WebAppContext"</span><span class="re2">&gt;</span></span>
  <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span><span class="re1">&lt;Ref</span> <span class="re0">id</span>=<span class="st0">"Contexts"</span><span class="re2">/&gt;</span><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
  <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span><span class="re1">&lt;SystemProperty</span> <span class="re0">name</span>=<span class="st0">"jetty.home"</span> <span class="re0">default</span>=<span class="st0">"."</span><span class="re2">/&gt;</span></span>/webapps/test.war<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
  <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>/test<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
   <span class="sc3"><span class="re1">&lt;Call</span> <span class="re0">name</span>=<span class="st0">"setAttribute"</span><span class="re2">&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>.*/.*jsp-api-[^/]*\.jar$|.*/.*jsp-[^/]*\.jar$|.*/.*taglibs[^/]*\.jar$<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
   <span class="sc3"><span class="re1">&lt;/Call<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/New<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                  <p>
                    <br />
                  </p>
                  <h3>
                    <span class="mw-headline" id="Jetty_8.x">Jetty 8.x</span>
                  </h3>
                  <p>
                    The version of JSP 2.2 engine that jetty uses employs a Servlet 3.0 way of finding tlds (see
                    <a class="external text" href="http://download.oracle.com/javaee/6/api/javax/servlet/ServletContainerInitializer.html" rel="nofollow">ServletContainerInitializer.html</a>
                    ) , and thus does
                    <i>not</i>
                    require that you define
                    <tt>org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern</tt>
                    .
                  </p>
                  <h2>
                    <span class="mw-headline" id="Using_JSF_Taglibs">Using JSF Taglibs</span>
                  </h2>
                  <h3>
                    <span class="mw-headline" id="Jetty_Standalone">Jetty Standalone</span>
                  </h3>
                  <p>
                    If you want to use JSF with your webapp, you need to copy the jsf implementation jar (ie whichever Jar contains the
                    <tt>META-INF/*.tld</tt>
                    files from your chosen JSF implementation) into
                    <tt>$JETTY_HOME/lib/jsp</tt>
                    . This is because the version of the jsp engine from Glassfish that we are using
                    <i>requires</i>
                    that the JSF tags are on the container's classpath, and
                    <i>not</i>
                    on the webapp's classpath.
                  </p>
                  <p>
                    If you are using
                    <b>jetty-7.x</b>
                    , then you will need to add the jsf implementation jar to the set of container jars that are scanned for TLDs. The set of jars is specified as a java Pattern as the value of the ContextAttribute
                    <tt>org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern</tt>
                    . You need to add a pattern that matches the name of the implementation jar.
                  </p>
                  <p>You can set this ContextAttribute on just a particular webapp, or for all webapps.</p>
                  <p>
                    To set on just one webapp, create or edit a
                    <a class="mw-redirect removed" title="Jetty/Feature/ContextDeployer">context xml</a>
                    file that describes your webapp. Assuming the implementation jar is called
                    <tt>javax.faces-2.1.6.jar</tt>
                    :
                  </p>
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve"><span class="sc3"><span class="re1">&lt;Configure</span> <span class="re0">class</span>=<span class="st0">"org.eclipse.jetty.webapp.WebAppContext"</span><span class="re2">&gt;</span></span>
 
    <span class="sc3"><span class="re1">&lt;Call</span> <span class="re0">name</span>=<span class="st0">"setAttribute"</span><span class="re2">&gt;</span></span>
      <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>.*/.*javax.faces-[^/]*\.jar$|.*/.*jsp-api-[^/]*\.jar$|.*/.*jsp-[^/]*\.jar$|.*/.*taglibs[^/]*\.jar$<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/Call<span class="re2">&gt;</span></span></span>
 
<span class="sc3"><span class="re1">&lt;/Configure<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                  <p>
                    If you're deploying via code, the equivalent is to call the
                    <a class="external text" href="https://archive.eclipse.org/jetty/7.6.16.v20140903/apidocs/org/eclipse/jetty/webapp/WebAppContext.html" rel="nofollow">WebAppContext.setAttribute(String name, String value)</a>
                    method.
                  </p>
                  <p>
                    If you'd like to use jsf with all of your webapps, then assuming you're using the
                    <a href="../Feature/Deployment%20Manager.html" title="Jetty/Feature/Deployment Manager">DeploymentManager</a>
                    , edit
                    <tt>$JETTY_HOME/etc/jetty-deploy.xml</tt>
                    . Assuming the implementation jar is named
                    <tt>javax.faces-2.1.6.jar</tt>
                    :
                  </p>
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve"> 
 <span class="sc3"><span class="re1">&lt;New</span> <span class="re0">id</span>=<span class="st0">"DeploymentManager"</span> <span class="re0">class</span>=<span class="st0">"org.eclipse.jetty.deploy.DeploymentManager"</span><span class="re2">&gt;</span></span>
          <span class="sc3"><span class="re1">&lt;Set</span> <span class="re0">name</span>=<span class="st0">"contexts"</span><span class="re2">&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;Ref</span> <span class="re0">id</span>=<span class="st0">"Contexts"</span> <span class="re2">/&gt;</span></span>
          <span class="sc3"><span class="re1">&lt;/Set<span class="re2">&gt;</span></span></span>
          <span class="sc3"><span class="re1">&lt;Call</span> <span class="re0">name</span>=<span class="st0">"setContextAttribute"</span><span class="re2">&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
            <span class="sc3"><span class="re1">&lt;Arg<span class="re2">&gt;</span></span></span>.*/.*javax.faces-[^/]*\.jar$|.*/.*jsp-api-[^/]*\.jar$|.*/.*jsp-[^/]*\.jar$|.*/.*taglibs[^/]*\.jar$<span class="sc3"><span class="re1">&lt;/Arg<span class="re2">&gt;</span></span></span>
          <span class="sc3"><span class="re1">&lt;/Call<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                  <p>
                    If you are using
                    <b>jetty-8.x</b>
                    you do not need to add this pattern because Servlet Spec. 3.0 uses a different method of finding TLD descriptors.
                  </p>
                  <h3>
                    <span class="mw-headline" id="Jetty_Maven_Plugin_2">Jetty Maven Plugin</span>
                  </h3>
                  <p>
                    For versions prior to 7.5.0, then your jsf jars
                    <i>should be normal webapp dependencies</i>
                    . You do not need to do anything else to configure jetty for use with jsf.
                  </p>
                  <p>
                    From versions 7.5.0 onwards, the version of the jsp engine from Glassfish that we are using
                    <i>requires</i>
                    that the JSF tags are on the container's classpath, and
                    <i>not</i>
                    on the webapp's classpath, so you need to make your jsf jars dependencies of the
                    <i>plugin</i>
                    and
                    <i>not</i>
                    the webapp itself, eg:
                  </p>
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve">   <span class="sc3"><span class="re1">&lt;plugin<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;groupId<span class="re2">&gt;</span></span></span>org.mortbay.jetty<span class="sc3"><span class="re1">&lt;/groupId<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;artifactId<span class="re2">&gt;</span></span></span>jetty-maven-plugin<span class="sc3"><span class="re1">&lt;/artifactId<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;configuration<span class="re2">&gt;</span></span></span>
       <span class="sc3"><span class="re1">&lt;webAppConfig<span class="re2">&gt;</span></span></span>
         <span class="sc3"><span class="re1">&lt;contextPath<span class="re2">&gt;</span></span></span>/${artifactId}<span class="sc3"><span class="re1">&lt;/contextPath<span class="re2">&gt;</span></span></span>
       <span class="sc3"><span class="re1">&lt;/webAppConfig<span class="re2">&gt;</span></span></span>
       <span class="sc3"><span class="re1">&lt;scanIntervalSeconds<span class="re2">&gt;</span></span></span>5<span class="sc3"><span class="re1">&lt;/scanIntervalSeconds<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/configuration<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;dependencies<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;dependency<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;groupId<span class="re2">&gt;</span></span></span>com.sun.faces<span class="sc3"><span class="re1">&lt;/groupId<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;artifactId<span class="re2">&gt;</span></span></span>jsf-api<span class="sc3"><span class="re1">&lt;/artifactId<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;version<span class="re2">&gt;</span></span></span>2.0.8<span class="sc3"><span class="re1">&lt;/version<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;/dependency<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;dependency<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;groupId<span class="re2">&gt;</span></span></span>com.sun.faces<span class="sc3"><span class="re1">&lt;/groupId<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;artifactId<span class="re2">&gt;</span></span></span>jsf-impl<span class="sc3"><span class="re1">&lt;/artifactId<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;version<span class="re2">&gt;</span></span></span>2.0.8<span class="sc3"><span class="re1">&lt;/version<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;/dependency<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/dependencies<span class="re2">&gt;</span></span></span>
  <span class="sc3"><span class="re1">&lt;/plugin<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                  <p>From versions 7.5.0 to 7.6.1, the maven jetty plugin will not scan the jsf dependency jars for the tlds containing the startup listeners. If you are using these versions, we recommend you upgrade to a more recent version. If this is not possible, then you should define the relevant listener in your web.xml:</p>
                  <p>For MyFaces:</p>
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve"> <span class="sc3"><span class="re1">&lt;listener<span class="re2">&gt;</span></span></span>
     <span class="sc3"><span class="re1">&lt;listener-class<span class="re2">&gt;</span></span></span>org.apache.myfaces.webapp.StartupServletContextListener<span class="sc3"><span class="re1">&lt;/listener-class<span class="re2">&gt;</span></span></span>
 <span class="sc3"><span class="re1">&lt;/listener<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                  <p>For Mojarra:</p>
                  <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                    <div class="xml source-xml">
                      <pre class="de1" xml:space="preserve">  <span class="sc3"><span class="re1">&lt;listener<span class="re2">&gt;</span></span></span>
       <span class="sc3"><span class="re1">&lt;listener-class<span class="re2">&gt;</span></span></span>com.sun.faces.config.ConfigureListener<span class="sc3"><span class="re1">&lt;/listener-class<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/listener<span class="re2">&gt;</span></span></span></pre>
                    </div>
                  </div>
                  From version 7.6.2 onwards the jetty plugin will ensure that the tlds containing the startup listeners from the 2 most common jsf implementations (Mojarra and MyFaces) will be automatically detected.
                </li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
