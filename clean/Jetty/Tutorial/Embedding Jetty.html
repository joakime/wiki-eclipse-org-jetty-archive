<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Jetty WTP Plugin</title>
    <link href="wiki-style.css" media="screen, print" rel="stylesheet" />
  </head>
  <body>
    <div class="col-md-20" id="mainContent">
      <div class="tab-content background-white">
        <div class="tab-pane active" id="tab-pane-main-page-content">
          <h1 class="firstHeading page-header" id="firstHeading">
            <span dir="auto">Jetty/Tutorial/Embedding Jetty</span>
          </h1>
          <div id="main-page-content">
            <div class="alert alert-small alert-warning" id="contentSub">
              <span class="subpages">
                &lt;
                <a href="../../Jetty.html" title="Jetty">Jetty</a>
                 |
                <a href="../Tutorial.html" title="Jetty/Tutorial">Tutorial</a>
              </span>
            </div>
            <div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en">
              <p>
                <br />
              </p>
              <p>
                <br />
              </p>
              <div class="toc" id="toc">
                <div id="toctitle">
                  <h2>Contents</h2>
                </div>
                <ul>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Introduction">
                      <span class="tocnumber">1</span>
                      <span class="toctext">Introduction</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Details">
                      <span class="tocnumber">2</span>
                      <span class="toctext">Details</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Creating_a_Server">
                      <span class="tocnumber">3</span>
                      <span class="toctext">Creating a Server</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Writing_Handlers">
                      <span class="tocnumber">4</span>
                      <span class="toctext">Writing Handlers</span>
                    </a>
                    <ul>
                      <li class="toclevel-2">
                        <a href="Embedding Jetty.html#Hello_World_Handler">
                          <span class="tocnumber">4.1</span>
                          <span class="toctext">Hello World Handler</span>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Configuring_Connectors">
                      <span class="tocnumber">5</span>
                      <span class="toctext">Configuring Connectors</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Understanding_Handler_Collections.2C_Wrappers_and_Scopes">
                      <span class="tocnumber">6</span>
                      <span class="toctext">Understanding Handler Collections, Wrappers and Scopes</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Configuring_a_File_Server">
                      <span class="tocnumber">7</span>
                      <span class="toctext">Configuring a File Server</span>
                    </a>
                    <ul>
                      <li class="toclevel-2">
                        <a href="Embedding Jetty.html#Configuring_a_File_Server_with_XML">
                          <span class="tocnumber">7.1</span>
                          <span class="toctext">Configuring a File Server with XML</span>
                        </a>
                      </li>
                      <li class="toclevel-2">
                        <a href="Embedding Jetty.html#Using_Spring_to_Configure_a_File_Server">
                          <span class="tocnumber">7.2</span>
                          <span class="toctext">Using Spring to Configure a File Server</span>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Setting_Contexts">
                      <span class="tocnumber">8</span>
                      <span class="toctext">Setting Contexts</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Creating_Servlets">
                      <span class="tocnumber">9</span>
                      <span class="toctext">Creating Servlets</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Setting_a_ServletContext">
                      <span class="tocnumber">10</span>
                      <span class="toctext">Setting a ServletContext</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Setting_a_Web_Application_Context">
                      <span class="tocnumber">11</span>
                      <span class="toctext">Setting a Web Application Context</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Configuring_a_Context_Handler_Collection">
                      <span class="tocnumber">12</span>
                      <span class="toctext">Configuring a Context Handler Collection</span>
                    </a>
                  </li>
                  <li class="toclevel-1">
                    <a href="Embedding Jetty.html#Embedding_JSP">
                      <span class="tocnumber">13</span>
                      <span class="toctext">Embedding JSP</span>
                    </a>
                  </li>
                </ul>
              </div>
              <h2>
                <span class="mw-headline" id="Introduction">Introduction</span>
              </h2>
              <p>
                <br />
                Jetty has a slogan, "Don't deploy your application in Jetty, deploy Jetty in your application." What this means is that as an alternative to bundling your application as a standard WAR to be deployed in Jetty, Jetty is designed to be a software component that can be instantiated and used in a Java program just like any
                <a class="external text" href="http://en.wikipedia.org/wiki/Plain_Old_Java_Object" rel="nofollow">POJO</a>
                . Put another way, running Jetty in embedded mode means putting an HTTP module into your application, rather than putting your application into an HTTP server.
              </p>
              <p>
                This tutorial takes you step-by-step from the simplest Jetty server instantiation to running multiple web applications with standards-based deployment descriptors. The
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/embedded/package-summary.html" rel="nofollow">source</a>
                for most of these examples is part of the standard Jetty project.
              </p>
              <p>
                Before doing this tutorial, it is worth while to do the
                <a href="Jetty HelloWorld.html" title="Jetty/Tutorial/Jetty HelloWorld">Hello World</a>
                tutorial. This tutorial is also available as a
                <a class="external text" href="http://vimeo.com/19146453" rel="nofollow">Embedding Jetty Webinar recording</a>
                .
              </p>
              <h2>
                <span class="mw-headline" id="Details">Details</span>
              </h2>
              <p>To embed a Jetty server, the following steps are typical:</p>
              <ol>
                <li>Create the server</li>
                <li>Add/Configure Connectors</li>
                <li>Add/Configure Handlers</li>
                <li>Add/Configure Servlets/Webapps to Handlers</li>
                <li>Start the server</li>
                <li>Wait (join the server to prevent main exiting)</li>
              </ol>
              <h2>
                <span class="mw-headline" id="Creating_a_Server">Creating a Server</span>
              </h2>
              <p>
                The following code from
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/embedded/SimplestServer.html" rel="nofollow">SimplestServer.java</a>
                instantiates and runs the simplest possible Jetty server:
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    SimplestServer
                    <span class="br0">{</span>
                    <span class="kw1">public</span>
                    <span class="kw1">static</span>
                    <span class="kw4">void</span>
                    main
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    args
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">Exception</span>
                    <span class="br0">{</span>
                    Server server
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    Server
                    <span class="br0">(</span>
                    <span class="nu0">8080</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">start</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">join</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <p>This runs an HTTP server on port 8080.  It is not a very useful server as it has no handlers and thus returns a 404 error for every request.</p>
              <p>
                <br />
              </p>
              <h2>
                <span class="mw-headline" id="Writing_Handlers">Writing Handlers</span>
              </h2>
              <p>
                To produce a response to a request, Jetty requires a
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/Handler.html" rel="nofollow">Handler</a>
                to be set on the server.  A handler may:
              </p>
              <ul>
                <li>Examine/modify the HTTP request.</li>
                <li>Generate the complete HTTP response.</li>
                <li>
                  Call another Handler (see
                  <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/HandlerWrapper.html" rel="nofollow">HandlerWrapper</a>
                  ).
                </li>
                <li>
                  Select one or many Handlers to call (see
                  <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/HandlerCollection.html" rel="nofollow">HandlerCollection</a>
                  ).
                </li>
              </ul>
              <h3>
                <span class="mw-headline" id="Hello_World_Handler">Hello World Handler</span>
              </h3>
              <p>
                The following code based on
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/embedded/HelloHandler.html" rel="nofollow">HelloHandler.java</a>
                shows a simple hello world handler:
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    HelloHandler
                    <span class="kw1">extends</span>
                    AbstractHandler
                    <span class="br0">{</span>
                    <span class="kw1">public</span>
                    <span class="kw4">void</span>
                    handle
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    target,
                    <span class="kw3">Request</span>
                    baseRequest,HttpServletRequest request,HttpServletResponse response
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">IOException</span>
                    , ServletException
                    <span class="br0">{</span>
                    response.
                    <span class="me1">setContentType</span>
                    <span class="br0">(</span>
                    <span class="st0">"text/html;charset=utf-8"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    response.
                    <span class="me1">setStatus</span>
                    <span class="br0">(</span>
                    HttpServletResponse.
                    <span class="me1">SC_OK</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    baseRequest.
                    <span class="me1">setHandled</span>
                    <span class="br0">(</span>
                    <span class="kw2">true</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    response.
                    <span class="me1">getWriter</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    .
                    <span class="me1">println</span>
                    <span class="br0">(</span>
                    <span class="st0">"&lt;h1&gt;Hello World&lt;/h1&gt;"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <p>The parameters passed to the handle method are:</p>
              <ul>
                <li>target–the target of the request, which is either a URI or a name from a named dispatcher.</li>
                <li>baseRequest–the Jetty mutable request object, which is always unwrapped.</li>
                <li>request–the immutable request object, which might have been wrapped.</li>
                <li>response–the response, which might have been wrapped.</li>
              </ul>
              <p>The handler sets the response status, content-type and marks the request as handled before it generates the body of the response using a writer.</p>
              <p>
                The following code from
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/embedded/OneHandler.html" rel="nofollow">OneHandler.java</a>
                shows how a Jetty server can use this handler:
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">static</span>
                    <span class="kw4">void</span>
                    main
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    args
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">Exception</span>
                    <span class="br0">{</span>
                    Server server
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    Server
                    <span class="br0">(</span>
                    <span class="nu0">8080</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">setHandler</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    HelloHandler
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">start</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">join</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <p>
                You now know everything you need to know to write an HTTP server based on Jetty.  However, complex request handling is typically built from multiple Handlers. We will look in later sections at how you can combine handlers like aspects. You can see some of the handlers available in Jetty in the
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/package-frame.html" rel="nofollow">org.eclipse.jetty.server.handler</a>
                package.
              </p>
              <h2>
                <span class="mw-headline" id="Configuring_Connectors">Configuring Connectors</span>
              </h2>
              <p>
                To configure the HTTP connectors that the server uses, you can set one or more
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/Connector.html" rel="nofollow">connector</a>
                s on the server. You can configure each connector with details such as interface, port, buffer sizes, timeouts, etc.
              </p>
              <p>
                The following code is based on
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/embedded/ManyConnectors.html" rel="nofollow">ManyConnectors.java</a>
                and shows how to set and configure connectors for the Hello World example:
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    ManyConnectors
                    <span class="br0">{</span>
                    <span class="kw1">public</span>
                    <span class="kw1">static</span>
                    <span class="kw4">void</span>
                    main
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    args
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">Exception</span>
                    <span class="br0">{</span>
                    Server server
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    Server
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    SelectChannelConnector connector0
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    SelectChannelConnector
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    connector0.
                    <span class="me1">setPort</span>
                    <span class="br0">(</span>
                    <span class="nu0">8080</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    connector0.
                    <span class="me1">setMaxIdleTime</span>
                    <span class="br0">(</span>
                    <span class="nu0">30000</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    connector0.
                    <span class="me1">setRequestHeaderSize</span>
                    <span class="br0">(</span>
                    <span class="nu0">8192</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    SelectChannelConnector connector1
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    SelectChannelConnector
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    connector1.
                    <span class="me1">setHost</span>
                    <span class="br0">(</span>
                    <span class="st0">"127.0.0.1"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    connector1.
                    <span class="me1">setPort</span>
                    <span class="br0">(</span>
                    <span class="nu0">8888</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    connector1.
                    <span class="me1">setThreadPool</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    QueuedThreadPool
                    <span class="br0">(</span>
                    <span class="nu0">20</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    connector1.
                    <span class="me1">setName</span>
                    <span class="br0">(</span>
                    <span class="st0">"admin"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    SslSelectChannelConnector ssl_connector
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    SslSelectChannelConnector
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="kw3">String</span>
                    jetty_home
                    <span class="sy0">=</span>
                    <span class="kw3">System</span>
                    .
                    <span class="me1">getProperty</span>
                    <span class="br0">(</span>
                    <span class="st0">"jetty.home"</span>
                    ,
                    <span class="st0">"../jetty-distribution/target/distribution"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="kw3">System</span>
                    .
                    <span class="me1">setProperty</span>
                    <span class="br0">(</span>
                    <span class="st0">"jetty.home"</span>
                    ,jetty_home
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    ssl_connector.
                    <span class="me1">setPort</span>
                    <span class="br0">(</span>
                    <span class="nu0">8443</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    SslContextFactory cf
                    <span class="sy0">=</span>
                    ssl_connector.
                    <span class="me1">getSslContextFactory</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    cf.
                    <span class="me1">setKeyStore</span>
                    <span class="br0">(</span>
                    jetty_home
                    <span class="sy0">+</span>
                    <span class="st0">"/etc/keystore"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    cf.
                    <span class="me1">setKeyStorePassword</span>
                    <span class="br0">(</span>
                    <span class="st0">"OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    cf.
                    <span class="me1">setKeyManagerPassword</span>
                    <span class="br0">(</span>
                    <span class="st0">"OBF:1u2u1wml1z7s1z7a1wnl1u2g"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">setConnectors</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    Connector
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    <span class="br0">{</span>
                    connector0, connector1, ssl_connector
                    <span class="br0">}</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">setHandler</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    HelloHandler
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">start</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">join</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <h2>
                <span class="mw-headline" id="Understanding_Handler_Collections.2C_Wrappers_and_Scopes">Understanding Handler Collections, Wrappers and Scopes</span>
              </h2>
              <p>Complex request handling is typically built from multiple Handlers that can be combined in various ways:</p>
              <ul>
                <li>
                  A
                  <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/HandlerCollection.html" rel="nofollow">Handler Collection</a>
                  holds a collection of other handlers and calls each handler in order. This is useful for combining statistics and logging handlers with the handler that generates the response.
                </li>
                <li>
                  A
                  <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/HandlerList.html" rel="nofollow">Handler List</a>
                  is a Handler Collection that calls each handler in turn until either an exception is thrown, the response is committed or the request.isHandled() returns true. It can be used to combine handlers that conditionally handle a request.
                </li>
                <li>
                  A
                  <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/HandlerWrapper.html" rel="nofollow">Handler Wrapper</a>
                  is a handler base class that can be used to daisy chain handlers together in the style of aspect-oriented programming.  For example, a standard web application is implemented by a chain of a context, session, security and servlet handlers.
                </li>
                <li>
                  A
                  <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/ContextHandlerCollection.html" rel="nofollow">Context Handler Collection</a>
                  uses the longest prefix of the request URI (the contextPath) to select a specific
                  <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/ContextHandler.html" rel="nofollow">ContextHandler</a>
                  to handle the request.
                </li>
              </ul>
              <p>
                See also
                <a href="../Howto/Write Jetty Handler.html" title="Jetty/Howto/Write Jetty Handler">How to Write a Jetty Handler</a>
                .
              </p>
              <h2>
                <span class="mw-headline" id="Configuring_a_File_Server">Configuring a File Server</span>
              </h2>
              <p>
                The following code from
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/embedded/FileServer.html" rel="nofollow">FileServer.java</a>
                uses a HandlerList to combine the
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/ResourceHandler.html" rel="nofollow">ResourceHandler</a>
                with the
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/DefaultHandler.html" rel="nofollow">DefaultHandler</a>
                :
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    FileServer
                    <span class="br0">{</span>
                    <span class="kw1">public</span>
                    <span class="kw1">static</span>
                    <span class="kw4">void</span>
                    main
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    args
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">Exception</span>
                    <span class="br0">{</span>
                    Server server
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    Server
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    SelectChannelConnector connector
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    SelectChannelConnector
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    connector.
                    <span class="me1">setPort</span>
                    <span class="br0">(</span>
                    <span class="nu0">8080</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">addConnector</span>
                    <span class="br0">(</span>
                    connector
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    ResourceHandler resource_handler
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    ResourceHandler
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    resource_handler.
                    <span class="me1">setDirectoriesListed</span>
                    <span class="br0">(</span>
                    <span class="kw2">true</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    resource_handler.
                    <span class="me1">setWelcomeFiles</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    <span class="br0">{</span>
                    <span class="st0">"index.html"</span>
                    <span class="br0">}</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    resource_handler.
                    <span class="me1">setResourceBase</span>
                    <span class="br0">(</span>
                    <span class="st0">"."</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    HandlerList handlers
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    HandlerList
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    handlers.
                    <span class="me1">setHandlers</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    Handler
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    <span class="br0">{</span>
                    resource_handler,
                    <span class="kw1">new</span>
                    DefaultHandler
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="br0">}</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">setHandler</span>
                    <span class="br0">(</span>
                    handlers
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">start</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">join</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <p>The resource handler is passed the request first and looks for a matching file in the local directory to serve. If it does not find a file, the request passes to the default handler which  generates a 404 (or favicon.ico).</p>
              <h3>
                <span class="mw-headline" id="Configuring_a_File_Server_with_XML">Configuring a File Server with XML</span>
              </h3>
              <p>
                Now is a good time to remind you that the
                <a href="../Reference/jetty.xml syntax.html" title="Jetty/Reference/jetty.xml syntax">Jetty XML</a>
                configuration format can render simple Java code into XML configuration.  So the File Server example above can be written with a little reordering in Jetty XML as follows:
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="xml source-xml">
                  <pre class="de1">
                    <span class="sc3">
                      <span class="re1">&lt;?xml</span>
                      <span class="re0">version</span>
                      =
                      <span class="st0">"1.0"</span>
                      <span class="re2">?&gt;</span>
                    </span>
                    <span class="sc0">&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "http://www.eclipse.org/jetty/configure.dtd"&gt;</span>
                    <span class="sc3">
                      <span class="re1">&lt;Configure</span>
                      <span class="re0">id</span>
                      =
                      <span class="st0">"FileServer"</span>
                      <span class="re0">class</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.Server"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;Call</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"addConnector"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;Arg
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;New</span>
                      <span class="re0">class</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.nio.SelectChannelConnector"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;Set</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"port"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    8080
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Set
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/New
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Arg
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Call
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;Set</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"handler"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;New</span>
                      <span class="re0">class</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.handler.HandlerList"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;Set</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"handlers"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;Array</span>
                      <span class="re0">type</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.Handler"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;Item
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;New</span>
                      <span class="re0">class</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.handler.ResourceHandler"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;Set</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"directoriesListed"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    true
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Set
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;Set</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"welcomeFiles"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;Array</span>
                      <span class="re0">type</span>
                      =
                      <span class="st0">"String"</span>
                      <span class="re2">&gt;</span>
                      <span class="re1">
                        &lt;Item
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    index.html
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Item
                        <span class="re2">&gt;</span>
                      </span>
                      <span class="re1">
                        &lt;/Array
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Set
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;Set</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"resourceBase"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    .
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Set
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/New
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Item
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;Item
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;New</span>
                      <span class="re0">class</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.handler.DefaultHandler"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/New
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Item
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Array
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Set
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/New
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Set
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/Configure
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                  </pre>
                </div>
              </div>
              <p>
                You can run this XML file from the
                <a class="external text" href="http://dev.eclipse.org/svnroot/rt/org.eclipse.jetty/jetty/trunk/example-jetty-embedded/src/main/java/org/eclipse/jetty/embedded/FileServerXml.java" rel="nofollow">FileServerXml.java</a>
                class:
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    FileServerXml
                    <span class="br0">{</span>
                    <span class="kw1">public</span>
                    <span class="kw1">static</span>
                    <span class="kw4">void</span>
                    main
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    args
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">Exception</span>
                    <span class="br0">{</span>
                    Resource fileserver_xml
                    <span class="sy0">=</span>
                    Resource.
                    <span class="me1">newSystemResource</span>
                    <span class="br0">(</span>
                    <span class="st0">"fileserver.xml"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    XmlConfiguration configuration
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    XmlConfiguration
                    <span class="br0">(</span>
                    fileserver_xml.
                    <span class="me1">getInputStream</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    Server server
                    <span class="sy0">=</span>
                    <span class="br0">(</span>
                    Server
                    <span class="br0">)</span>
                    configuration.
                    <span class="me1">configure</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">start</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">join</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <h3>
                <span class="mw-headline" id="Using_Spring_to_Configure_a_File_Server">Using Spring to Configure a File Server</span>
              </h3>
              <p>You can also use the Spring framework to assemble Jetty servers.  The file server example above can be written in Spring configuration as:</p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="xml source-xml">
                  <pre class="de1">
                    <span class="sc3">
                      <span class="re1">
                        &lt;beans
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;bean</span>
                      <span class="re0">id</span>
                      =
                      <span class="st0">"Server"</span>
                      <span class="re0">class</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.Server"</span>
                      <span class="re0">init-method</span>
                      =
                      <span class="st0">"start"</span>
                      <span class="re0">destroy-method</span>
                      =
                      <span class="st0">"stop"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;property</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"connectors"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;list
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;bean</span>
                      <span class="re0">id</span>
                      =
                      <span class="st0">"Connector"</span>
                      <span class="re0">class</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.nio.SelectChannelConnector"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;property</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"port"</span>
                      <span class="re0">value</span>
                      =
                      <span class="st0">"8080"</span>
                      <span class="re2">/&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/bean
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/list
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/property
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;property</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"handler"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;bean</span>
                      <span class="re0">id</span>
                      =
                      <span class="st0">"handlers"</span>
                      <span class="re0">class</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.handler.HandlerList"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;property</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"handlers"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;list
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;bean</span>
                      <span class="re0">class</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.handler.ResourceHandler"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;property</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"directoriesListed"</span>
                      <span class="re0">value</span>
                      =
                      <span class="st0">"true"</span>
                      <span class="re2">/&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;property</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"welcomeFiles"</span>
                      <span class="re2">&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;list
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;value
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    index.html
                    <span class="sc3">
                      <span class="re1">
                        &lt;/value
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/list
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/property
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;property</span>
                      <span class="re0">name</span>
                      =
                      <span class="st0">"resourceBase"</span>
                      <span class="re0">value</span>
                      =
                      <span class="st0">"."</span>
                      <span class="re2">/&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/bean
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">&lt;bean</span>
                      <span class="re0">class</span>
                      =
                      <span class="st0">"org.eclipse.jetty.server.handler.DefaultHandler"</span>
                      <span class="re2">/&gt;</span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/list
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/property
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/bean
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/property
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/bean
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                    <span class="sc3">
                      <span class="re1">
                        &lt;/beans
                        <span class="re2">&gt;</span>
                      </span>
                    </span>
                  </pre>
                </div>
              </div>
              <p>
                See also
                <a href="../Howto/Spring.html" title="Jetty/Howto/Spring">How to Configure Jetty with Spring</a>
                .
              </p>
              <h2>
                <span class="mw-headline" id="Setting_Contexts">Setting Contexts</span>
              </h2>
              <p>
                A
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/ContextHandler.html" rel="nofollow">ContextHandler</a>
                is a HandlerWrapper that responds only to requests that have a URI prefix that matches the configured context path.
              </p>
              <p>Requests that match the context path have their path methods updated accordingly, and the following optional context features applied as appropriate:</p>
              <pre>* A Thread Context classloader.
* A set of attributes
* A set of init parameters
* A resource base (aka document root)
* A set of virtual host names</pre>
              <p>Requests that don't match are not handled.</p>
              <p>
                The following code is based on
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/embedded/OneContext.html" rel="nofollow">OneContext.java</a>
                and sets context path and classloader for the hello handler:
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    OneContext
                    <span class="br0">{</span>
                    <span class="kw1">public</span>
                    <span class="kw1">static</span>
                    <span class="kw4">void</span>
                    main
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    args
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">Exception</span>
                    <span class="br0">{</span>
                    Server server
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    Server
                    <span class="br0">(</span>
                    <span class="nu0">8080</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    ContextHandler context
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    ContextHandler
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">setContextPath</span>
                    <span class="br0">(</span>
                    <span class="st0">"/hello"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">setResourceBase</span>
                    <span class="br0">(</span>
                    <span class="st0">"."</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">setClassLoader</span>
                    <span class="br0">(</span>
                    <span class="kw3">Thread</span>
                    .
                    <span class="me1">currentThread</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    .
                    <span class="me1">getContextClassLoader</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">setHandler</span>
                    <span class="br0">(</span>
                    context
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">setHandler</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    HelloHandler
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">start</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">join</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <h2>
                <span class="mw-headline" id="Creating_Servlets">Creating Servlets</span>
              </h2>
              <p>
                Servlets are the standard way to provide application logic that handles HTTP requests. Servlets are like constrained Handlers with standard ways to map specific URIs to specific servlets. The following code is based on
                <a class="external text" href="http://dev.eclipse.org/svnroot/rt/org.eclipse.jetty/jetty/trunk/example-jetty-embedded/src/main/java/org/eclipse/jetty/embedded/HelloServlet.java" rel="nofollow">HelloServlet.java</a>
                :
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    HelloServlet
                    <span class="kw1">extends</span>
                    HttpServlet
                    <span class="br0">{</span>
                    <span class="kw1">private</span>
                    <span class="kw3">String</span>
                    greeting
                    <span class="sy0">=</span>
                    <span class="st0">"Hello World"</span>
                    <span class="sy0">;</span>
                    <span class="kw1">public</span>
                    HelloServlet
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="br0">{</span>
                    <span class="br0">}</span>
                    <span class="kw1">public</span>
                    HelloServlet
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    greeting
                    <span class="br0">)</span>
                    <span class="br0">{</span>
                    <span class="kw1">this</span>
                    .
                    <span class="me1">greeting</span>
                    <span class="sy0">=</span>
                    greeting
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="kw1">protected</span>
                    <span class="kw4">void</span>
                    doGet
                    <span class="br0">(</span>
                    HttpServletRequest request, HttpServletResponse response
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    ServletException,
                    <span class="kw3">IOException</span>
                    <span class="br0">{</span>
                    response.
                    <span class="me1">setContentType</span>
                    <span class="br0">(</span>
                    <span class="st0">"text/html"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    response.
                    <span class="me1">setStatus</span>
                    <span class="br0">(</span>
                    HttpServletResponse.
                    <span class="me1">SC_OK</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    response.
                    <span class="me1">getWriter</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    .
                    <span class="me1">println</span>
                    <span class="br0">(</span>
                    <span class="st0">"&lt;h1&gt;"</span>
                    <span class="sy0">+</span>
                    greeting
                    <span class="sy0">+</span>
                    <span class="st0">"&lt;/h1&gt;"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    response.
                    <span class="me1">getWriter</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    .
                    <span class="me1">println</span>
                    <span class="br0">(</span>
                    <span class="st0">"session="</span>
                    <span class="sy0">+</span>
                    request.
                    <span class="me1">getSession</span>
                    <span class="br0">(</span>
                    <span class="kw2">true</span>
                    <span class="br0">)</span>
                    .
                    <span class="me1">getId</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <h2>
                <span class="mw-headline" id="Setting_a_ServletContext">Setting a ServletContext</span>
              </h2>
              <p>
                A
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/servlet/ServletContextHandler.html" rel="nofollow">ServletContextHandler</a>
                is a specialization of ContextHandler with support for standard servlets.  The following code from
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/embedded/OneServletContext.html" rel="nofollow">OneServletContext</a>
                shows three instances of the helloworld servlet registered with a ServletContextHandler:
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    OneServletContext
                    <span class="br0">{</span>
                    <span class="kw1">public</span>
                    <span class="kw1">static</span>
                    <span class="kw4">void</span>
                    main
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    args
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">Exception</span>
                    <span class="br0">{</span>
                    Server server
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    Server
                    <span class="br0">(</span>
                    <span class="nu0">8080</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    ServletContextHandler context
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    ServletContextHandler
                    <span class="br0">(</span>
                    ServletContextHandler.
                    <span class="me1">SESSIONS</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">setContextPath</span>
                    <span class="br0">(</span>
                    <span class="st0">"/"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">setHandler</span>
                    <span class="br0">(</span>
                    context
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">addServlet</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    ServletHolder
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    HelloServlet
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    ,
                    <span class="st0">"/*"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">addServlet</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    ServletHolder
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    HelloServlet
                    <span class="br0">(</span>
                    <span class="st0">"Buongiorno Mondo"</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    ,
                    <span class="st0">"/it/*"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">addServlet</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    ServletHolder
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    HelloServlet
                    <span class="br0">(</span>
                    <span class="st0">"Bonjour le Monde"</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    ,
                    <span class="st0">"/fr/*"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">start</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">join</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <h2>
                <span class="mw-headline" id="Setting_a_Web_Application_Context">Setting a Web Application Context</span>
              </h2>
              <p>
                A
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/webapp/WebAppContext.html" rel="nofollow">Web Applications context</a>
                is a variation of ServletContextHandler that uses the standard layout and web.xml to configure the servlets, filters and other features:
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    OneWebApp
                    <span class="br0">{</span>
                    <span class="kw1">public</span>
                    <span class="kw1">static</span>
                    <span class="kw4">void</span>
                    main
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    args
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">Exception</span>
                    <span class="br0">{</span>
                    <span class="kw3">String</span>
                    jetty_home
                    <span class="sy0">=</span>
                    <span class="kw3">System</span>
                    .
                    <span class="me1">getProperty</span>
                    <span class="br0">(</span>
                    <span class="st0">"jetty.home"</span>
                    ,
                    <span class="st0">".."</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    Server server
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    Server
                    <span class="br0">(</span>
                    <span class="nu0">8080</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    WebAppContext webapp
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    WebAppContext
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    webapp.
                    <span class="me1">setContextPath</span>
                    <span class="br0">(</span>
                    <span class="st0">"/"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    webapp.
                    <span class="me1">setWar</span>
                    <span class="br0">(</span>
                    jetty_home
                    <span class="sy0">+</span>
                    <span class="st0">"/webapps/test.war"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">setHandler</span>
                    <span class="br0">(</span>
                    webapp
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">start</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">join</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <p>If during development, you have not assembled your application into a WAR file, you can run it from its source components with something like:</p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    OneWebAppUnassembled
                    <span class="br0">{</span>
                    <span class="kw1">public</span>
                    <span class="kw1">static</span>
                    <span class="kw4">void</span>
                    main
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    args
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">Exception</span>
                    <span class="br0">{</span>
                    Server server
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    Server
                    <span class="br0">(</span>
                    <span class="nu0">8080</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    WebAppContext context
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    WebAppContext
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">setDescriptor</span>
                    <span class="br0">(</span>
                    webapp
                    <span class="sy0">+</span>
                    <span class="st0">"/WEB-INF/web.xml"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">setResourceBase</span>
                    <span class="br0">(</span>
                    <span class="st0">"../test-jetty-webapp/src/main/webapp"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">setContextPath</span>
                    <span class="br0">(</span>
                    <span class="st0">"/"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context.
                    <span class="me1">setParentLoaderPriority</span>
                    <span class="br0">(</span>
                    <span class="kw2">true</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">setHandler</span>
                    <span class="br0">(</span>
                    context
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">start</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">join</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <h2>
                <span class="mw-headline" id="Configuring_a_Context_Handler_Collection">Configuring a Context Handler Collection</span>
              </h2>
              <p>
                A
                <a class="external text" href="http://download.eclipse.org/jetty/stable-7/xref/org/eclipse/jetty/server/handler/ContextHandlerCollection.html" rel="nofollow">Context Handler Collection</a>
                uses the longest prefix of the request URI (the contextPath) to select a specific context.  The following example combines the previous two examples in a single Jetty server:
              </p>
              <div class="mw-geshi mw-code mw-content-ltr" dir="ltr">
                <div class="java source-java">
                  <pre class="de1">
                    <span class="kw1">public</span>
                    <span class="kw1">class</span>
                    ManyContexts
                    <span class="br0">{</span>
                    <span class="kw1">public</span>
                    <span class="kw1">static</span>
                    <span class="kw4">void</span>
                    main
                    <span class="br0">(</span>
                    <span class="kw3">String</span>
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    args
                    <span class="br0">)</span>
                    <span class="kw1">throws</span>
                    <span class="kw3">Exception</span>
                    <span class="br0">{</span>
                    Server server
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    Server
                    <span class="br0">(</span>
                    <span class="nu0">8080</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    ServletContextHandler context0
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    ServletContextHandler
                    <span class="br0">(</span>
                    ServletContextHandler.
                    <span class="me1">SESSIONS</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context0.
                    <span class="me1">setContextPath</span>
                    <span class="br0">(</span>
                    <span class="st0">"/ctx0"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context0.
                    <span class="me1">addServlet</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    ServletHolder
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    HelloServlet
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    ,
                    <span class="st0">"/*"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context0.
                    <span class="me1">addServlet</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    ServletHolder
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    HelloServlet
                    <span class="br0">(</span>
                    <span class="st0">"Buongiorno Mondo"</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    ,
                    <span class="st0">"/it/*"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    context0.
                    <span class="me1">addServlet</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    ServletHolder
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    HelloServlet
                    <span class="br0">(</span>
                    <span class="st0">"Bonjour le Monde"</span>
                    <span class="br0">)</span>
                    <span class="br0">)</span>
                    ,
                    <span class="st0">"/fr/*"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    WebAppContext webapp
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    WebAppContext
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    webapp.
                    <span class="me1">setContextPath</span>
                    <span class="br0">(</span>
                    <span class="st0">"/ctx1"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    webapp.
                    <span class="me1">setWar</span>
                    <span class="br0">(</span>
                    jetty_home
                    <span class="sy0">+</span>
                    <span class="st0">"/webapps/test.war"</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    ContextHandlerCollection contexts
                    <span class="sy0">=</span>
                    <span class="kw1">new</span>
                    ContextHandlerCollection
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    contexts.
                    <span class="me1">setHandlers</span>
                    <span class="br0">(</span>
                    <span class="kw1">new</span>
                    Handler
                    <span class="br0">[</span>
                    <span class="br0">]</span>
                    <span class="br0">{</span>
                    context0, webapp
                    <span class="br0">}</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">setHandler</span>
                    <span class="br0">(</span>
                    contexts
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">start</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    server.
                    <span class="me1">join</span>
                    <span class="br0">(</span>
                    <span class="br0">)</span>
                    <span class="sy0">;</span>
                    <span class="br0">}</span>
                    <span class="br0">}</span>
                  </pre>
                </div>
              </div>
              <h2>
                <span class="mw-headline" id="Embedding_JSP">Embedding JSP</span>
              </h2>
              <p>Embedding JSP support can be a bit confusing if you look at the Jars under the lib/jsp directory in the jetty distribution.  This is because we have to ship from Eclipse with the JSP bundles that are marked up as OSGi bundles, which you cannot directly download from Maven Central.  There are dependencies available in Maven Central that work because they were the actual source for the OSGi bundles themselves.  The OSGi bundles are simply these Maven Central artifacts decomposed into a few extra bundles.</p>
              <p>An example of what you can use follows:</p>
              <pre>[INFO] org.eclipse.jetty:jetty-jsp-2.1:jar:7.2.2-SNAPSHOT
[INFO] +- org.eclipse.jetty:jetty-util:jar:7.2.2-SNAPSHOT:provided
[INFO] +- org.mortbay.jetty:jsp-2.1-glassfish:jar:2.1.v20100127:provided
[INFO] |  +- org.eclipse.jdt.core.compiler:ecj:jar:3.5.1:provided
[INFO] |  +- org.mortbay.jetty:jsp-api-2.1-glassfish:jar:2.1.v20100127:provided
[INFO] |  \- ant:ant:jar:1.6.5:provided
[INFO] \- javax.servlet:servlet-api:jar:2.5:provided</pre>
              <p>You should be able to depend on one of the embedding aggregates that we provide to get these dependencies without too much trouble.</p>
              <p>
                <a class="external free" href="http://repo2.maven.org/maven2/org/eclipse/jetty/aggregate" rel="nofollow">http://repo2.maven.org/maven2/org/eclipse/jetty/aggregate</a>
              </p>
            </div>
            <div class="catlinks" id="catlinks">
              <div class="mw-normal-catlinks" id="mw-normal-catlinks">
                <a href="https://wiki.eclipse.org/Special:Categories" title="Special:Categories">Categories</a>
                :
                <ul>
                  <li>
                    <a href="https://wiki.eclipse.org/Category:Jetty" title="Category:Jetty">Jetty</a>
                  </li>
                  <li>
                    <a href="https://wiki.eclipse.org/Category:Jetty_Tutorial" title="Category:Jetty Tutorial">Jetty Tutorial</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
